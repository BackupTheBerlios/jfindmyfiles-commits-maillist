<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Jfindmyfiles-commits] r126 - in trunk: media/icons media/icons/x48	project/JFindMyFiles/Catalog	project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog	project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities	project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/utils	project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui	project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs	project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes	project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images	project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/jfindmyfiles-commits/2008-June/index.html" >
   <LINK REL="made" HREF="mailto:jfindmyfiles-commits%40lists.berlios.de?Subject=Re%3A%20%5BJfindmyfiles-commits%5D%20r126%20-%20in%20trunk%3A%20media/icons%20media/icons/x48%0A%09project/JFindMyFiles/Catalog%0A%09project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog%0A%09project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities%0A%09project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/utils%0A%09project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui%0A%09project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs%0A%09project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes%0A%09project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images%0A%09project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48&In-Reply-To=%3C200806022330.m52NUr6w022148%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   
   <LINK REL="Next"  HREF="000122.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Jfindmyfiles-commits] r126 - in trunk: media/icons media/icons/x48	project/JFindMyFiles/Catalog	project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog	project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities	project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/utils	project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui	project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs	project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes	project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images	project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48</H1>
    <B>knitter at mail.berlios.de</B> 
    <A HREF="mailto:jfindmyfiles-commits%40lists.berlios.de?Subject=Re%3A%20%5BJfindmyfiles-commits%5D%20r126%20-%20in%20trunk%3A%20media/icons%20media/icons/x48%0A%09project/JFindMyFiles/Catalog%0A%09project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog%0A%09project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities%0A%09project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/utils%0A%09project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui%0A%09project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs%0A%09project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes%0A%09project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images%0A%09project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48&In-Reply-To=%3C200806022330.m52NUr6w022148%40sheep.berlios.de%3E"
       TITLE="[Jfindmyfiles-commits] r126 - in trunk: media/icons media/icons/x48	project/JFindMyFiles/Catalog	project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog	project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities	project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/utils	project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui	project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs	project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes	project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images	project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48">knitter at mail.berlios.de
       </A><BR>
    <I>Tue Jun  3 01:30:53 CEST 2008</I>
    <P><UL>
        
        <LI>Next message: <A HREF="000122.html">[Jfindmyfiles-commits] r127 - in trunk/docs/Iteracao2-CB05: .	TestingDB
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#121">[ date ]</a>
              <a href="thread.html#121">[ thread ]</a>
              <a href="subject.html#121">[ subject ]</a>
              <a href="author.html#121">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: knitter
Date: 2008-06-03 01:30:26 +0200 (Tue, 03 Jun 2008)
New Revision: 126

Added:
   trunk/media/icons/x48/
   trunk/media/icons/x48/export-import-csv.png
   trunk/media/icons/x48/export-import-html.png
   trunk/media/icons/x48/export-import-ods.png
   trunk/media/icons/x48/export-import-sql.png
   trunk/media/icons/x48/export-import-xls.png
   trunk/media/icons/x48/export-import-xml.png
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/DiskGroupChildren.java
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/FileWrapperNode.java
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-csv.png
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-html.png
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-ods.png
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-sql.png
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-xls.png
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-xml.png
Removed:
   trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/Bundle.properties
   trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/layer.xml
Modified:
   trunk/project/JFindMyFiles/Catalog/manifest.mf
   trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/CatalogEngine.java
   trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities/DiskGroup.java
   trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities/Media.hbm.xml
   trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities/Type.java
   trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/utils/hibernate.general.cfg.xml
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/NavigationTreeTopComponent.java
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/CatalogPropertiesDlg.form
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/CatalogPropertiesDlg.java
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ExportDlg.form
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ExportDlg.java
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ImportDlg.form
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ImportDlg.java
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/OpenCatalogDlg.form
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/OpenCatalogDlg.java
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/CatalogChildren.java
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/CatalogNode.java
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/DiskGroupNode.java
   trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/DiskNode.java
Log:
Corrigido problema no mapeamento da classe Media. O sistema de lazy loading n?\195?\163o estava a funcionar correctamente e os dados n?\195?\163o estavam a ser lidos da base de dados.

Corrigido o bug que impedia a apresenta?\195?\167?\195?\163o dos n?\195?\179s correspondentes aos dados lidos da base de dados quando a mesma era aberta.

Adicionado c?\195?\179digo para mostrar outros tipos de n?\195?\179s, nomeadamente grupos de discos e discos.

Adicionado c?\195?\179digo para mostrar o menu de contexto quando se clica com o bot?\195?\163o direito no n?\195?\179 ra?\195?\173s.

Implementado c?\195?\179digo para verificar a viabiliade de se usar um CellRenderer para mostrar items nas listas das janelas de importa?\195?\167?\195?\163o e exporta?\195?\167?\195?\163o.

Efectuada alguma limpesa em ficheiros n?\195?\163o usados, como o caso do ficheiro layer.xml do projecto Catalog.

Adicionados novos ?\195?\173cons.

Added: trunk/media/icons/x48/export-import-csv.png
===================================================================
(Binary files differ)


Property changes on: trunk/media/icons/x48/export-import-csv.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/media/icons/x48/export-import-html.png
===================================================================
(Binary files differ)


Property changes on: trunk/media/icons/x48/export-import-html.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/media/icons/x48/export-import-ods.png
===================================================================
(Binary files differ)


Property changes on: trunk/media/icons/x48/export-import-ods.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/media/icons/x48/export-import-sql.png
===================================================================
(Binary files differ)


Property changes on: trunk/media/icons/x48/export-import-sql.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/media/icons/x48/export-import-xls.png
===================================================================
(Binary files differ)


Property changes on: trunk/media/icons/x48/export-import-xls.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/media/icons/x48/export-import-xml.png
===================================================================
(Binary files differ)


Property changes on: trunk/media/icons/x48/export-import-xml.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/project/JFindMyFiles/Catalog/manifest.mf
===================================================================
--- trunk/project/JFindMyFiles/Catalog/manifest.mf	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/Catalog/manifest.mf	2008-06-02 23:30:26 UTC (rev 126)
@@ -1,6 +1,4 @@
 Manifest-Version: 1.0
 OpenIDE-Module: de.berlios.jfindmyfiles.catalog
-OpenIDE-Module-Layer: de/berlios/jfindmyfiles/catalog/layer.xml
-OpenIDE-Module-Localizing-Bundle: de/berlios/jfindmyfiles/catalog/Bundle.properties
 OpenIDE-Module-Specification-Version: 1.0
 

Deleted: trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/Bundle.properties
===================================================================
--- trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/Bundle.properties	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/Bundle.properties	2008-06-02 23:30:26 UTC (rev 126)
@@ -1,20 +0,0 @@
-###
- #  Copyright (C) 2008  Patr\u00EDcia Monteiro e S\u00E9rgio Lopes
- #
- #  This file is part of JFindMyFiles.
- #
- #  JFindMyFiles is free software: you can redistribute it and/or modify
- #  it under the terms of the GNU General Public License as published by
- #  the Free Software Foundation, either version 2 of the License, or
- #  (at your option) any later version.
- #
- #  JFindMyFiles is distributed in the hope that it will be useful,
- #  but WITHOUT ANY WARRANTY; without even the implied warranty of
- #  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- #  GNU General Public License for more details.
- #
- #  You should have received a copy of the GNU General Public License
- #  along with JFindMyFiles.  If not, see 
- # &lt;<A HREF="http://www.gnu.org/licenses/gpl.html">http://www.gnu.org/licenses/gpl.html</A>&gt;.
- ##
-OpenIDE-Module-Name=Catalog

Modified: trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/CatalogEngine.java
===================================================================
--- trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/CatalogEngine.java	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/CatalogEngine.java	2008-06-02 23:30:26 UTC (rev 126)
@@ -113,6 +113,9 @@
                     hConfig.setProperty(&quot;hibernate.connection.url&quot;, &quot;jdbc:hsqldb:file:&quot; + dburl + &quot;/&quot; + dbname);
                     hConfig.setProperty(&quot;hibernate.connection.username&quot;, &quot;sa&quot;);//Default user for every HSQLDB database
 
+                    //Try to shutdown the database as soon as there all connections are gone
+                    hConfig.setProperty(&quot;hibernate.connection.shutdown&quot;, &quot;true&quot;);
+                    
                     hConfig.setProperty(&quot;hibernate.connection.password&quot;, &quot;&quot;);//HSQLDB has a user with no password
 
             }
@@ -372,6 +375,9 @@
     @Override
     public void finalize() {
         if (sessionFactory != null &amp;&amp; !sessionFactory.isClosed()) {
+            Session s = sessionFactory.getCurrentSession();
+            s.beginTransaction();
+            //s.createSQLQuery(&quot;SHUTDOWN&quot;).
             sessionFactory.close();
         }
     }

Modified: trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities/DiskGroup.java
===================================================================
--- trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities/DiskGroup.java	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities/DiskGroup.java	2008-06-02 23:30:26 UTC (rev 126)
@@ -154,7 +154,7 @@
         }
 
         DiskGroup other = (DiskGroup) obj;
-        return name.equals(other.name) &amp;&amp; description.equals(other.description) &amp;&amp; parent.equals(other.parent);
+        return name.equals(other.name) &amp;&amp; description.equals(other.description);
     }
 
     //TODO: link for the equals method
@@ -170,7 +170,6 @@
         hash = 83 * hash + (this.name != null ? this.name.hashCode() : 0);
         hash = 83 * hash + (this.description != null ? this.description.hashCode()
                 : 0);
-        hash = 83 * hash + (this.parent != null ? this.parent.hashCode() : 0);
         return hash;
     }
 

Modified: trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities/Media.hbm.xml
===================================================================
--- trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities/Media.hbm.xml	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities/Media.hbm.xml	2008-06-02 23:30:26 UTC (rev 126)
@@ -45,7 +45,7 @@
             &lt;one-to-many class=&quot;de.berlios.jfindmyfiles.catalog.entities.FileWrapper&quot;/&gt;
         &lt;/set&gt;
 
-        &lt;many-to-one name=&quot;type&quot; class=&quot;de.berlios.jfindmyfiles.catalog.entities.Type&quot; column=&quot;TYPE_ID&quot; not-null=&quot;true&quot;/&gt;
+        &lt;many-to-one name=&quot;type&quot; class=&quot;de.berlios.jfindmyfiles.catalog.entities.Type&quot; column=&quot;TYPE_ID&quot; not-null=&quot;true&quot; lazy=&quot;false&quot;/&gt;
         
         &lt;join table=&quot;TBL_GROUP_MEDIA&quot; optional=&quot;true&quot;&gt;
             &lt;key column=&quot;MEDIA_ID&quot;/&gt;

Modified: trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities/Type.java
===================================================================
--- trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities/Type.java	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/entities/Type.java	2008-06-02 23:30:26 UTC (rev 126)
@@ -77,6 +77,7 @@
         Type other = (Type) obj;
         return name.equals(other.name);
     }
+    
     //TODO: link for the equals method
     /**
      * HashCode for this object, excluding the id field.

Deleted: trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/layer.xml
===================================================================
--- trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/layer.xml	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/layer.xml	2008-06-02 23:30:26 UTC (rev 126)
@@ -1,28 +0,0 @@
-&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
-&lt;!--
- *  Copyright (C) 2008  Patr&#237;cia Monteiro e S&#233;rgio Lopes
- *
- *  This file is part of JFindMyFiles.
- *
- *  JFindMyFiles is free software: you can redistribute it and/or modify
- *  it under the terms of the GNU General Public License as published by
- *  the Free Software Foundation, either version 2 of the License, or
- *  (at your option) any later version.
- *
- *  JFindMyFiles is distributed in the hope that it will be useful,
- *  but WITHOUT ANY WARRANTY; without even the implied warranty of
- *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
- *  GNU General Public License for more details.
- *
- *  You should have received a copy of the GNU General Public License
- *  along with JFindMyFiles.  If not, see 
- * &lt;<A HREF="http://www.gnu.org/licenses/gpl.html">http://www.gnu.org/licenses/gpl.html</A>&gt;.
- --&gt;
-&lt;!DOCTYPE filesystem PUBLIC &quot;-//NetBeans//DTD Filesystem 1.1//EN&quot; &quot;<A HREF="http://www.netbeans.org/dtds/filesystem-1_1.dtd">http://www.netbeans.org/dtds/filesystem-1_1.dtd</A>&quot;&gt;
-&lt;filesystem&gt;
-&lt;!--    &lt;folder name=&quot;CatalogEngine&quot;&gt;
-        &lt;file name=&quot;de-berlios-jfindmyfiles-catalog-CatalogEngine.instance&quot;&gt;
-            &lt;attr name=&quot;instanceClass&quot; stringvalue=&quot;de.berlios.jfindmyfiles.catalog.CatalogEngine&quot;/&gt;
-        &lt;/file&gt;
-    &lt;/folder&gt; --&gt;
-&lt;/filesystem&gt;

Modified: trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/utils/hibernate.general.cfg.xml
===================================================================
--- trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/utils/hibernate.general.cfg.xml	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/Catalog/src/de/berlios/jfindmyfiles/catalog/utils/hibernate.general.cfg.xml	2008-06-02 23:30:26 UTC (rev 126)
@@ -45,6 +45,8 @@
         
         &lt;!-- //TODO: remove this line and replace with proper one --&gt;
         &lt;!-- &lt;property name=&quot;hbm2ddl.auto&quot;&gt;create&lt;/property&gt; --&gt;
+        &lt;!-- 
+        &lt;property name=&quot;hibernate.connection.shutdown&quot;&gt;true&lt;/property&gt; --&gt;
 
         &lt;mapping resource=&quot;de/berlios/jfindmyfiles/catalog/entities/AudioData.hbm.xml&quot;/&gt;
         &lt;mapping resource=&quot;de/berlios/jfindmyfiles/catalog/entities/DiskGroup.hbm.xml&quot;/&gt;

Modified: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/NavigationTreeTopComponent.java
===================================================================
--- trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/NavigationTreeTopComponent.java	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/NavigationTreeTopComponent.java	2008-06-02 23:30:26 UTC (rev 126)
@@ -27,9 +27,13 @@
 import java.awt.BorderLayout;
 import java.io.Serializable;
 import java.util.logging.Logger;
+import javax.swing.ActionMap;
 import org.openide.explorer.ExplorerManager;
+import org.openide.explorer.ExplorerUtils;
 import org.openide.explorer.view.BeanTreeView;
 import org.openide.util.Lookup;
+import org.openide.util.LookupEvent;
+import org.openide.util.LookupListener;
 import org.openide.util.NbBundle;
 import org.openide.util.lookup.Lookups;
 import org.openide.windows.TopComponent;
@@ -73,11 +77,11 @@
     //manager.setRootContext(new RssNode.RootRssNode());
     } catch (DataObjectNotFoundException ex) {
     ErrorManager.getDefault().notify(ex);
-    }
+    }*/
     
     ActionMap map = getActionMap();
-    map.put(&quot;delete&quot;, ExplorerUtils.actionDelete(manager, true));
-    associateLookup(ExplorerUtils.createLookup(manager, map));*/
+    //map.put(&quot;delete&quot;, ExplorerUtils.actionDelete(manager, true));
+    //associateLookup(ExplorerUtils.createLookup(manager, map));
     }
 
     /** This method is called from within the constructor to

Modified: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/CatalogPropertiesDlg.form
===================================================================
--- trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/CatalogPropertiesDlg.form	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/CatalogPropertiesDlg.form	2008-06-02 23:30:26 UTC (rev 126)
@@ -210,9 +210,6 @@
                 &lt;Property name=&quot;columns&quot; type=&quot;int&quot; value=&quot;20&quot;/&gt;
                 &lt;Property name=&quot;rows&quot; type=&quot;int&quot; value=&quot;5&quot;/&gt;
               &lt;/Properties&gt;
-              &lt;Events&gt;
-                &lt;EventHandler event=&quot;keyTyped&quot; listener=&quot;java.awt.event.KeyListener&quot; parameters=&quot;java.awt.event.KeyEvent&quot; handler=&quot;jtaDescriptionKeyTyped&quot;/&gt;
-              &lt;/Events&gt;
             &lt;/Component&gt;
           &lt;/SubComponents&gt;
         &lt;/Container&gt;

Modified: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/CatalogPropertiesDlg.java
===================================================================
--- trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/CatalogPropertiesDlg.java	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/CatalogPropertiesDlg.java	2008-06-02 23:30:26 UTC (rev 126)
@@ -23,6 +23,8 @@
 import de.berlios.jfindmyfiles.catalog.entities.CatalogProperties;
 import java.util.Date;
 import javax.swing.ImageIcon;
+import javax.swing.event.DocumentEvent;
+import javax.swing.event.DocumentListener;
 import org.openide.util.Lookup;
 import org.openide.util.Utilities;
 
@@ -34,13 +36,28 @@
 
     private CatalogEngine eng;
     private CatalogProperties props;
-    private boolean alterado = false;
+    private boolean changed = false;
 
     /** Creates new form CatalogPropertiesDlg */
     public CatalogPropertiesDlg(java.awt.Frame parent, boolean modal) {
         super(parent, modal);
         initComponents();
+        
+        jtaDescription.getDocument().addDocumentListener(new DocumentListener() {
 
+            public void insertUpdate(DocumentEvent e) {
+                changed = true;
+            }
+
+            public void removeUpdate(DocumentEvent e) {
+                changed = true;
+            }
+
+            public void changedUpdate(DocumentEvent e) {
+                changed = true;
+            }
+        });
+
         eng = Lookup.getDefault().lookup(CatalogEngine.class);
         fillIn();
     }
@@ -121,11 +138,6 @@
 
         jtaDescription.setColumns(20);
         jtaDescription.setRows(5);
-        jtaDescription.addKeyListener(new java.awt.event.KeyAdapter() {
-            public void keyTyped(java.awt.event.KeyEvent evt) {
-                jtaDescriptionKeyTyped(evt);
-            }
-        });
         jscrDescription.setViewportView(jtaDescription);
 
         jlblTotalSize.setText(org.openide.util.NbBundle.getMessage(CatalogPropertiesDlg.class, &quot;CatalogPropertiesDlg.jlblTotalSize.text&quot;)); // NOI18N
@@ -272,8 +284,8 @@
 
 private void jbtnOKActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jbtnOKActionPerformed
     //TODO: better control over detached object
-    if (alterado &amp;&amp; eng != null &amp;&amp; props != null) {
-        alterado = false;
+    if (changed &amp;&amp; eng != null &amp;&amp; props != null) {
+        changed = false;
         props.setCreationDate(jdcCreatedOn.getDate());
         props.setDescription(jtaDescription.getText().trim());
         eng.updateProperties();
@@ -281,16 +293,11 @@
     dispose();
 }//GEN-LAST:event_jbtnOKActionPerformed
 
-private void jtaDescriptionKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jtaDescriptionKeyTyped
-    //NOTE: this event is probably not the best one to use
-    alterado = true;
-}//GEN-LAST:event_jtaDescriptionKeyTyped
-
 private void jdcCreatedOnPropertyChange(java.beans.PropertyChangeEvent evt) {//GEN-FIRST:event_jdcCreatedOnPropertyChange
     //NOTE: jcalenar component does no provide events for listning to date 
     // changes  
     if (evt.getPropertyName().equals(&quot;date&quot;)) {
-        alterado = true;
+        changed = true;
     }
 }//GEN-LAST:event_jdcCreatedOnPropertyChange
 

Modified: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ExportDlg.form
===================================================================
--- trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ExportDlg.form	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ExportDlg.form	2008-06-02 23:30:26 UTC (rev 126)
@@ -93,7 +93,7 @@
                   &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                       &lt;Component id=&quot;jPanel3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;jPanel4&quot; pref=&quot;357&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jPanel4&quot; pref=&quot;408&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
                   &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
                       &lt;Component id=&quot;jButton2&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
@@ -112,7 +112,7 @@
           &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Component id=&quot;jPanel4&quot; pref=&quot;389&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                  &lt;Component id=&quot;jPanel4&quot; pref=&quot;426&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
                   &lt;Component id=&quot;jPanel3&quot; alignment=&quot;1&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
               &lt;/Group&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
@@ -151,7 +151,7 @@
         &lt;DimensionLayout dim=&quot;1&quot;&gt;
           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
               &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Component id=&quot;jScrollPane1&quot; pref=&quot;348&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;jScrollPane1&quot; pref=&quot;385&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
           &lt;/Group&gt;
@@ -165,21 +165,24 @@
 
           &lt;Layout class=&quot;org.netbeans.modules.form.compat2.layouts.support.JScrollPaneSupportLayout&quot;/&gt;
           &lt;SubComponents&gt;
-            &lt;Component class=&quot;javax.swing.JList&quot; name=&quot;jList1&quot;&gt;
+            &lt;Component class=&quot;javax.swing.JList&quot; name=&quot;jlstExportTypes&quot;&gt;
               &lt;Properties&gt;
                 &lt;Property name=&quot;model&quot; type=&quot;javax.swing.ListModel&quot; editor=&quot;org.netbeans.modules.form.editors2.ListModelEditor&quot;&gt;
-                  &lt;StringArray count=&quot;5&quot;&gt;
-                    &lt;StringItem index=&quot;0&quot; value=&quot;Item 1&quot;/&gt;
-                    &lt;StringItem index=&quot;1&quot; value=&quot;Item 2&quot;/&gt;
-                    &lt;StringItem index=&quot;2&quot; value=&quot;Item 3&quot;/&gt;
-                    &lt;StringItem index=&quot;3&quot; value=&quot;Item 4&quot;/&gt;
-                    &lt;StringItem index=&quot;4&quot; value=&quot;Item 5&quot;/&gt;
-                  &lt;/StringArray&gt;
+                  &lt;StringArray count=&quot;0&quot;/&gt;
                 &lt;/Property&gt;
+                &lt;Property name=&quot;selectionMode&quot; type=&quot;int&quot; value=&quot;0&quot;/&gt;
+                &lt;Property name=&quot;cellRenderer&quot; type=&quot;javax.swing.ListCellRenderer&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+                  &lt;Connection code=&quot;new Renderer()&quot; type=&quot;code&quot;/&gt;
+                &lt;/Property&gt;
+                &lt;Property name=&quot;fixedCellHeight&quot; type=&quot;int&quot; value=&quot;62&quot;/&gt;
+                &lt;Property name=&quot;visibleRowCount&quot; type=&quot;int&quot; value=&quot;6&quot;/&gt;
               &lt;/Properties&gt;
               &lt;Events&gt;
-                &lt;EventHandler event=&quot;valueChanged&quot; listener=&quot;javax.swing.event.ListSelectionListener&quot; parameters=&quot;javax.swing.event.ListSelectionEvent&quot; handler=&quot;jList1ValueChanged&quot;/&gt;
+                &lt;EventHandler event=&quot;valueChanged&quot; listener=&quot;javax.swing.event.ListSelectionListener&quot; parameters=&quot;javax.swing.event.ListSelectionEvent&quot; handler=&quot;jlstExportTypesValueChanged&quot;/&gt;
               &lt;/Events&gt;
+              &lt;AuxValues&gt;
+                &lt;AuxValue name=&quot;JavaCodeGenerator_CreateCodeCustom&quot; type=&quot;java.lang.String&quot; value=&quot;new JList(values);&quot;/&gt;
+              &lt;/AuxValues&gt;
             &lt;/Component&gt;
           &lt;/SubComponents&gt;
         &lt;/Container&gt;
@@ -202,7 +205,7 @@
                   &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                       &lt;EmptySpace min=&quot;-2&quot; pref=&quot;124&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;jLabel3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace pref=&quot;188&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace pref=&quot;250&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
             &lt;/DimensionLayout&gt;
@@ -211,7 +214,7 @@
                   &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                       &lt;EmptySpace min=&quot;-2&quot; pref=&quot;170&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;jLabel3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace pref=&quot;202&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace pref=&quot;242&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
             &lt;/DimensionLayout&gt;
@@ -239,7 +242,7 @@
                   &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                       &lt;EmptySpace min=&quot;-2&quot; pref=&quot;122&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;jLabel4&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace pref=&quot;190&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace pref=&quot;252&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
             &lt;/DimensionLayout&gt;
@@ -248,7 +251,7 @@
                   &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                       &lt;EmptySpace min=&quot;-2&quot; pref=&quot;166&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;jLabel4&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace pref=&quot;206&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace pref=&quot;246&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
             &lt;/DimensionLayout&gt;

Modified: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ExportDlg.java
===================================================================
--- trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ExportDlg.java	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ExportDlg.java	2008-06-02 23:30:26 UTC (rev 126)
@@ -21,6 +21,13 @@
 
 import java.awt.BorderLayout;
 import java.awt.CardLayout;
+import java.awt.Component;
+import javax.swing.ImageIcon;
+import javax.swing.JLabel;
+import javax.swing.JList;
+import javax.swing.ListCellRenderer;
+import javax.swing.SwingConstants;
+import org.openide.util.Utilities;
 
 /**
  *
@@ -28,10 +35,20 @@
  */
 public class ExportDlg extends javax.swing.JDialog {
 
+    /*private static final int EXPORT_CVS = 0;
+    private static final int EXPORT_HTML = 1;
+    private static final int EXPORT_ODS = 2;
+    private static final int EXPORT_XLS = 3;
+    private static final int EXPORT_XML = 4;
+    private static final int EXPORT_SQL = 5;*/
+    private Integer[] values = new Integer[]{0, 1, 2, 3, 4, 5};
+
     /** Creates new form ExportDlg */
     public ExportDlg(java.awt.Frame parent, boolean modal) {
         super(parent, modal);
         initComponents();
+
+        //TODO:
         jPanel1.setVisible(true);
         jPanel2.setVisible(false);
         this.add(jPanel2, BorderLayout.CENTER);
@@ -59,7 +76,7 @@
         jLabel1 = new javax.swing.JLabel();
         jPanel3 = new javax.swing.JPanel();
         jScrollPane1 = new javax.swing.JScrollPane();
-        jList1 = new javax.swing.JList();
+        jlstExportTypes = new JList(values);
         jPanel4 = new javax.swing.JPanel();
         jPanel5 = new javax.swing.JPanel();
         jLabel3 = new javax.swing.JLabel();
@@ -111,17 +128,16 @@
 
         jPanel3.setBorder(javax.swing.BorderFactory.createTitledBorder(org.openide.util.NbBundle.getMessage(ExportDlg.class, &quot;ExportDlg.jPanel3.border.title&quot;))); // NOI18N
 
-        jList1.setModel(new javax.swing.AbstractListModel() {
-            String[] strings = { &quot;Item 1&quot;, &quot;Item 2&quot;, &quot;Item 3&quot;, &quot;Item 4&quot;, &quot;Item 5&quot; };
-            public int getSize() { return strings.length; }
-            public Object getElementAt(int i) { return strings[i]; }
-        });
-        jList1.addListSelectionListener(new javax.swing.event.ListSelectionListener() {
+        jlstExportTypes.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
+        jlstExportTypes.setCellRenderer(new Renderer());
+        jlstExportTypes.setFixedCellHeight(62);
+        jlstExportTypes.setVisibleRowCount(6);
+        jlstExportTypes.addListSelectionListener(new javax.swing.event.ListSelectionListener() {
             public void valueChanged(javax.swing.event.ListSelectionEvent evt) {
-                jList1ValueChanged(evt);
+                jlstExportTypesValueChanged(evt);
             }
         });
-        jScrollPane1.setViewportView(jList1);
+        jScrollPane1.setViewportView(jlstExportTypes);
 
         javax.swing.GroupLayout jPanel3Layout = new javax.swing.GroupLayout(jPanel3);
         jPanel3.setLayout(jPanel3Layout);
@@ -135,7 +151,7 @@
         jPanel3Layout.setVerticalGroup(
             jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
             .addGroup(jPanel3Layout.createSequentialGroup()
-                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 348, Short.MAX_VALUE)
+                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 385, Short.MAX_VALUE)
                 .addContainerGap())
         );
 
@@ -150,14 +166,14 @@
             .addGroup(jPanel5Layout.createSequentialGroup()
                 .addGap(124, 124, 124)
                 .addComponent(jLabel3)
-                .addContainerGap(188, Short.MAX_VALUE))
+                .addContainerGap(250, Short.MAX_VALUE))
         );
         jPanel5Layout.setVerticalGroup(
             jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
             .addGroup(jPanel5Layout.createSequentialGroup()
                 .addGap(170, 170, 170)
                 .addComponent(jLabel3)
-                .addContainerGap(202, Short.MAX_VALUE))
+                .addContainerGap(242, Short.MAX_VALUE))
         );
 
         jPanel4.add(jPanel5, &quot;card2&quot;);
@@ -171,14 +187,14 @@
             .addGroup(jPanel6Layout.createSequentialGroup()
                 .addGap(122, 122, 122)
                 .addComponent(jLabel4)
-                .addContainerGap(190, Short.MAX_VALUE))
+                .addContainerGap(252, Short.MAX_VALUE))
         );
         jPanel6Layout.setVerticalGroup(
             jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
             .addGroup(jPanel6Layout.createSequentialGroup()
                 .addGap(166, 166, 166)
                 .addComponent(jLabel4)
-                .addContainerGap(206, Short.MAX_VALUE))
+                .addContainerGap(246, Short.MAX_VALUE))
         );
 
         jPanel4.add(jPanel6, &quot;card3&quot;);
@@ -214,7 +230,7 @@
                     .addGroup(layout.createSequentialGroup()
                         .addComponent(jPanel3, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                         .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                        .addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE, 357, Short.MAX_VALUE))
+                        .addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE, 408, Short.MAX_VALUE))
                     .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                         .addComponent(jButton2)
                         .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
@@ -228,7 +244,7 @@
             .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                 .addContainerGap()
                 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
-                    .addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE, 389, Short.MAX_VALUE)
+                    .addComponent(jPanel4, javax.swing.GroupLayout.DEFAULT_SIZE, 426, Short.MAX_VALUE)
                     .addComponent(jPanel3, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                 .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
@@ -241,15 +257,15 @@
         pack();
     }// &lt;/editor-fold&gt;//GEN-END:initComponents
 
-private void jList1ValueChanged(javax.swing.event.ListSelectionEvent evt) {//GEN-FIRST:event_jList1ValueChanged
-    if(jList1.getSelectedIndex() == 0) {
-        CardLayout lay = (CardLayout)jPanel4.getLayout();
+private void jlstExportTypesValueChanged(javax.swing.event.ListSelectionEvent evt) {//GEN-FIRST:event_jlstExportTypesValueChanged
+    if (jlstExportTypes.getSelectedIndex() == 0) {
+        CardLayout lay = (CardLayout) jPanel4.getLayout();
         lay.first(jPanel4);
     } else {
-        CardLayout lay = (CardLayout)jPanel4.getLayout();
-        lay.last(jPanel4);        
+        CardLayout lay = (CardLayout) jPanel4.getLayout();
+        lay.last(jPanel4);
     }
-}//GEN-LAST:event_jList1ValueChanged
+}//GEN-LAST:event_jlstExportTypesValueChanged
 
 private void jButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton1ActionPerformed
     dispose();
@@ -262,7 +278,6 @@
 private void jButton3ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton3ActionPerformed
 // TODO add your handling code here:
 }//GEN-LAST:event_jButton3ActionPerformed
-
     // Variables declaration - do not modify//GEN-BEGIN:variables
     private javax.swing.JButton jButton1;
     private javax.swing.JButton jButton2;
@@ -271,7 +286,6 @@
     private javax.swing.JLabel jLabel2;
     private javax.swing.JLabel jLabel3;
     private javax.swing.JLabel jLabel4;
-    private javax.swing.JList jList1;
     private javax.swing.JPanel jPanel1;
     private javax.swing.JPanel jPanel2;
     private javax.swing.JPanel jPanel3;
@@ -279,5 +293,47 @@
     private javax.swing.JPanel jPanel5;
     private javax.swing.JPanel jPanel6;
     private javax.swing.JScrollPane jScrollPane1;
+    private javax.swing.JList jlstExportTypes;
     // End of variables declaration//GEN-END:variables
+    
+    /**
+     * Renderer class for showing icons on the list of existing export options
+     */
+    private class Renderer extends JLabel implements ListCellRenderer {
+
+        private ImageIcon[] images;
+
+        public Renderer() {
+            images = new ImageIcon[]{
+                        new ImageIcon(Utilities.loadImage(&quot;de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-csv.png&quot;)),
+                        new ImageIcon(Utilities.loadImage(&quot;de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-html.png&quot;)),
+                        new ImageIcon(Utilities.loadImage(&quot;de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-ods.png&quot;)),
+                        new ImageIcon(Utilities.loadImage(&quot;de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-xls.png&quot;)),
+                        new ImageIcon(Utilities.loadImage(&quot;de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-xml.png&quot;)),
+                        new ImageIcon(Utilities.loadImage(&quot;de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-sql.png&quot;))
+                    };
+
+            setOpaque(true);
+            setHorizontalAlignment(SwingConstants.CENTER);
+            setVerticalAlignment(SwingConstants.CENTER);
+        }
+
+        public Component getListCellRendererComponent(JList list, Object value,
+                int index, boolean isSelected, boolean cellHasFocus) {
+
+            int selectedIndex = ((Integer) value).intValue();
+
+            if (isSelected) {
+                setBackground(list.getSelectionBackground());
+                setForeground(list.getSelectionForeground());
+            } else {
+                setBackground(list.getBackground());
+                setForeground(list.getForeground());
+            }
+
+            setIcon(images[selectedIndex]);
+            setFont(list.getFont());
+            return this;
+        }
+    }
 }

Modified: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ImportDlg.form
===================================================================
--- trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ImportDlg.form	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ImportDlg.form	2008-06-02 23:30:26 UTC (rev 126)
@@ -46,7 +46,7 @@
           &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Component id=&quot;jPanel2&quot; pref=&quot;401&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;jPanel2&quot; pref=&quot;403&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;jPanel1&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
@@ -74,6 +74,9 @@
           &lt;ResourceString bundle=&quot;de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/Bundle.properties&quot; key=&quot;ImportDlg.jButton2.text&quot; replaceFormat=&quot;org.openide.util.NbBundle.getMessage({sourceFileName}.class, &quot;{key}&quot;)&quot;/&gt;
         &lt;/Property&gt;
       &lt;/Properties&gt;
+      &lt;Events&gt;
+        &lt;EventHandler event=&quot;actionPerformed&quot; listener=&quot;java.awt.event.ActionListener&quot; parameters=&quot;java.awt.event.ActionEvent&quot; handler=&quot;jButton2ActionPerformed&quot;/&gt;
+      &lt;/Events&gt;
     &lt;/Component&gt;
     &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;jButton3&quot;&gt;
       &lt;Properties&gt;
@@ -155,7 +158,7 @@
             &lt;/DimensionLayout&gt;
             &lt;DimensionLayout dim=&quot;1&quot;&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;EmptySpace min=&quot;0&quot; pref=&quot;401&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;EmptySpace min=&quot;0&quot; pref=&quot;403&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
             &lt;/DimensionLayout&gt;
           &lt;/Layout&gt;
@@ -175,7 +178,7 @@
             &lt;/DimensionLayout&gt;
             &lt;DimensionLayout dim=&quot;1&quot;&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;EmptySpace min=&quot;0&quot; pref=&quot;401&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;EmptySpace min=&quot;0&quot; pref=&quot;403&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
             &lt;/DimensionLayout&gt;
           &lt;/Layout&gt;
@@ -195,7 +198,7 @@
             &lt;/DimensionLayout&gt;
             &lt;DimensionLayout dim=&quot;1&quot;&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;EmptySpace min=&quot;0&quot; pref=&quot;401&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;EmptySpace min=&quot;0&quot; pref=&quot;403&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
             &lt;/DimensionLayout&gt;
           &lt;/Layout&gt;

Modified: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ImportDlg.java
===================================================================
--- trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ImportDlg.java	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/ImportDlg.java	2008-06-02 23:30:26 UTC (rev 126)
@@ -63,6 +63,11 @@
         jButton1.setText(org.openide.util.NbBundle.getMessage(ImportDlg.class, &quot;ImportDlg.jButton1.text&quot;)); // NOI18N
 
         jButton2.setText(org.openide.util.NbBundle.getMessage(ImportDlg.class, &quot;ImportDlg.jButton2.text&quot;)); // NOI18N
+        jButton2.addActionListener(new java.awt.event.ActionListener() {
+            public void actionPerformed(java.awt.event.ActionEvent evt) {
+                jButton2ActionPerformed(evt);
+            }
+        });
 
         jButton3.setText(org.openide.util.NbBundle.getMessage(ImportDlg.class, &quot;ImportDlg.jButton3.text&quot;)); // NOI18N
 
@@ -102,7 +107,7 @@
         );
         jPanel3Layout.setVerticalGroup(
             jPanel3Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
-            .addGap(0, 401, Short.MAX_VALUE)
+            .addGap(0, 403, Short.MAX_VALUE)
         );
 
         jPanel2.add(jPanel3, &quot;card2&quot;);
@@ -115,7 +120,7 @@
         );
         jPanel4Layout.setVerticalGroup(
             jPanel4Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
-            .addGap(0, 401, Short.MAX_VALUE)
+            .addGap(0, 403, Short.MAX_VALUE)
         );
 
         jPanel2.add(jPanel4, &quot;card3&quot;);
@@ -128,7 +133,7 @@
         );
         jPanel5Layout.setVerticalGroup(
             jPanel5Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
-            .addGap(0, 401, Short.MAX_VALUE)
+            .addGap(0, 403, Short.MAX_VALUE)
         );
 
         jPanel2.add(jPanel5, &quot;card4&quot;);
@@ -157,7 +162,7 @@
             .addGroup(layout.createSequentialGroup()
                 .addContainerGap()
                 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
-                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, 401, Short.MAX_VALUE)
+                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, 403, Short.MAX_VALUE)
                     .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                 .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                 .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
@@ -170,6 +175,10 @@
         pack();
     }// &lt;/editor-fold&gt;//GEN-END:initComponents
 
+private void jButton2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton2ActionPerformed
+    dispose();
+}//GEN-LAST:event_jButton2ActionPerformed
+
     // Variables declaration - do not modify//GEN-BEGIN:variables
     private javax.swing.JButton jButton1;
     private javax.swing.JButton jButton2;

Modified: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/OpenCatalogDlg.form
===================================================================
--- trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/OpenCatalogDlg.form	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/OpenCatalogDlg.form	2008-06-02 23:30:26 UTC (rev 126)
@@ -30,12 +30,12 @@
                   &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                       &lt;Component id=&quot;jlblName&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;jtfName&quot; pref=&quot;450&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jtfName&quot; pref=&quot;492&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
                   &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                       &lt;Component id=&quot;jchkUserinternalDB&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;jSeparator1&quot; pref=&quot;334&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jSeparator1&quot; pref=&quot;394&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
                   &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                       &lt;EmptySpace min=&quot;12&quot; pref=&quot;12&quot; max=&quot;12&quot; attributes=&quot;0&quot;/&gt;
@@ -44,7 +44,7 @@
                           &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                               &lt;Component id=&quot;jlblDestination&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                              &lt;Component id=&quot;jtfDestination&quot; pref=&quot;393&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;Component id=&quot;jtfDestination&quot; pref=&quot;416&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                               &lt;Component id=&quot;jbtnBrowse&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;/Group&gt;
@@ -124,7 +124,7 @@
                           &lt;/Group&gt;
                           &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Component id=&quot;jtfHostname&quot; alignment=&quot;1&quot; pref=&quot;278&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;Component id=&quot;jtfHostname&quot; alignment=&quot;1&quot; pref=&quot;343&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                               &lt;Group type=&quot;103&quot; alignment=&quot;0&quot; groupAlignment=&quot;1&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
                                   &lt;Component id=&quot;jpfPassword&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
                                   &lt;Component id=&quot;jtfUsername&quot; alignment=&quot;0&quot; pref=&quot;141&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;

Modified: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/OpenCatalogDlg.java
===================================================================
--- trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/OpenCatalogDlg.java	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/dialogs/OpenCatalogDlg.java	2008-06-02 23:30:26 UTC (rev 126)
@@ -46,7 +46,7 @@
     private String findCatalogName(File folder) {
         File[] list = folder.listFiles();
         for (File f : list) {
-            if (f.getName().contains(&quot;.log&quot;)) {
+            if (f.getName().contains(&quot;.properties&quot;)) {
                 return f.getName().substring(0, f.getName().lastIndexOf(&quot;.&quot;));
             }
         }
@@ -204,7 +204,7 @@
                             .addComponent(jlblUsername))
                         .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                         .addGroup(jpDatabaseSettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
-                            .addComponent(jtfHostname, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 278, Short.MAX_VALUE)
+                            .addComponent(jtfHostname, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, 343, Short.MAX_VALUE)
                             .addGroup(jpDatabaseSettingsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                 .addComponent(jpfPassword, javax.swing.GroupLayout.Alignment.LEADING)
                                 .addComponent(jtfUsername, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 141, Short.MAX_VALUE)
@@ -296,11 +296,11 @@
                     .addGroup(layout.createSequentialGroup()
                         .addComponent(jlblName)
                         .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                        .addComponent(jtfName, javax.swing.GroupLayout.DEFAULT_SIZE, 450, Short.MAX_VALUE))
+                        .addComponent(jtfName, javax.swing.GroupLayout.DEFAULT_SIZE, 492, Short.MAX_VALUE))
                     .addGroup(layout.createSequentialGroup()
                         .addComponent(jchkUserinternalDB)
                         .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                        .addComponent(jSeparator1, javax.swing.GroupLayout.DEFAULT_SIZE, 334, Short.MAX_VALUE))
+                        .addComponent(jSeparator1, javax.swing.GroupLayout.DEFAULT_SIZE, 394, Short.MAX_VALUE))
                     .addGroup(layout.createSequentialGroup()
                         .addGap(12, 12, 12)
                         .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
@@ -308,7 +308,7 @@
                             .addGroup(layout.createSequentialGroup()
                                 .addComponent(jlblDestination)
                                 .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
-                                .addComponent(jtfDestination, javax.swing.GroupLayout.DEFAULT_SIZE, 393, Short.MAX_VALUE)
+                                .addComponent(jtfDestination, javax.swing.GroupLayout.DEFAULT_SIZE, 416, Short.MAX_VALUE)
                                 .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                                 .addComponent(jbtnBrowse))))
                     .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()

Modified: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/CatalogChildren.java
===================================================================
--- trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/CatalogChildren.java	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/CatalogChildren.java	2008-06-02 23:30:26 UTC (rev 126)
@@ -30,10 +30,10 @@
         eng = Lookup.getDefault().lookup(CatalogEngine.class);
         Session s = eng.sessionFactory.getCurrentSession();
         s.beginTransaction();
-        items.addAll(s.createQuery(&quot;from DiskGroup&quot;).list());
-        items.addAll(s.createQuery(&quot;from Media&quot;).list());
+        items.addAll(s.createQuery(&quot;from DiskGroup where parent.id is null&quot;).list());
+        items.addAll(s.createQuery(&quot;from Media where group.id is null&quot;).list());
         s.getTransaction().commit();
-    }
+    }  
 
     @Override
     protected void addNotify() {
@@ -44,7 +44,14 @@
     @Override
     protected Node[] createNodes(Object key) {
         if (key instanceof DiskGroup) {
-            DiskGroupNode gn = new DiskGroupNode((DiskGroup) key);
+            Session s = eng.sessionFactory.getCurrentSession();
+            s.beginTransaction();
+            List rs = s.createQuery(&quot;from DiskGroup group where parent.id = ?&quot;).setLong(0, ((DiskGroup) key).getId()).list();
+            rs.addAll(s.createQuery(&quot;from Media media where group.id = ?&quot;).setLong(0, ((DiskGroup) key).getId()).list());
+            s.getTransaction().commit();
+
+            DiskGroupNode gn = new DiskGroupNode((DiskGroup) key, rs.isEmpty());
+            
             return new Node[]{gn};
         }
         if (key instanceof Media) {

Modified: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/CatalogNode.java
===================================================================
--- trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/CatalogNode.java	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/CatalogNode.java	2008-06-02 23:30:26 UTC (rev 126)
@@ -20,42 +20,66 @@
 package de.berlios.jfindmyfiles.jfindmyfilesgui.nodes;
 
 import de.berlios.jfindmyfiles.catalog.CatalogEngine;
+import de.berlios.jfindmyfiles.jfindmyfilesgui.actions.ActionAddNewDisk;
+import de.berlios.jfindmyfiles.jfindmyfilesgui.actions.ActionAddNewDiskGroup;
+import de.berlios.jfindmyfiles.jfindmyfilesgui.actions.ActionClose;
+import de.berlios.jfindmyfiles.jfindmyfilesgui.actions.ActionExport;
+import de.berlios.jfindmyfiles.jfindmyfilesgui.actions.ActionImport;
+import de.berlios.jfindmyfiles.jfindmyfilesgui.actions.ActionProperties;
+import de.berlios.jfindmyfiles.jfindmyfilesgui.actions.ActionRenumberDisks;
+import de.berlios.jfindmyfiles.jfindmyfilesgui.actions.ActionScanForDuplicates;
+import de.berlios.jfindmyfiles.jfindmyfilesgui.actions.ActionSearchForItems;
+import de.berlios.jfindmyfiles.jfindmyfilesgui.actions.ActionUpdateAllDisks;
 import java.awt.Image;
+import java.awt.event.ActionEvent;
 import java.util.List;
 import org.openide.nodes.AbstractNode;
 import org.openide.nodes.ChildFactory;
 import org.openide.nodes.Children;
 import org.openide.nodes.Node;
+import org.openide.util.HelpCtx;
 import org.openide.util.Lookup;
 import org.openide.util.Utilities;
 import org.openide.util.actions.SystemAction;
+import org.openide.util.lookup.Lookups;
 
 /**
  *
  * @author knitter
  */
 public class CatalogNode extends AbstractNode {
-    
-    public CatalogNode(String name, boolean created) {              
+
+    private SystemAction[] sysact;
+
+    public CatalogNode(String name, boolean created) {
         //super(Children.create(new CatalogChildNodesFactory(), true));
-        //super(Children.LEAF);//TODO: populate child nodes
+        //TODO: populate child nodes
         super(created ? Children.LEAF : new CatalogChildren(null));
+
         CatalogEngine eng = Lookup.getDefault().lookup(CatalogEngine.class);
         setName(eng.getProperties().getName());
+        
+        Lookup lo = Lookups.forPath(&quot;/Actions&quot;);//TODO: sort actions correctly and add separators
+        sysact = new SystemAction[]{lo.lookup(ActionProperties.class),
+                    lo.lookup(ActionRenumberDisks.class), lo.lookup(ActionScanForDuplicates.class),
+                    lo.lookup(ActionSearchForItems.class), lo.lookup(ActionUpdateAllDisks.class),
+                    lo.lookup(ActionAddNewDisk.class), lo.lookup(ActionAddNewDiskGroup.class),
+                    lo.lookup(ActionClose.class), lo.lookup(ActionExport.class), lo.lookup(ActionImport.class)
+                };
     }
-    
+
     @Override
     public Image getIcon(int type) {
         return Utilities.loadImage(&quot;de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x16/icon-catalog.png&quot;); // NOI18N
     }
-    
+
     @Override
     public Image getOpenedIcon(int type) {
         return getIcon(type);
     }
-    
+
     @Override
     public SystemAction[] getActions(boolean bool) {
-        return new SystemAction[]{};
-    }   
+        return sysact;
+    }
 }

Added: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/DiskGroupChildren.java
===================================================================
--- trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/DiskGroupChildren.java	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/DiskGroupChildren.java	2008-06-02 23:30:26 UTC (rev 126)
@@ -0,0 +1,64 @@
+/*
+ * To change this template, choose Tools | Templates
+ * and open the template in the editor.
+ */
+
+package de.berlios.jfindmyfiles.jfindmyfilesgui.nodes;
+
+import de.berlios.jfindmyfiles.catalog.CatalogEngine;
+import de.berlios.jfindmyfiles.catalog.entities.DiskGroup;
+import de.berlios.jfindmyfiles.catalog.entities.Media;
+import java.util.LinkedList;
+import java.util.List;
+import org.hibernate.Session;
+import org.openide.nodes.Children;
+import org.openide.nodes.Node;
+import org.openide.util.Lookup;
+
+/**
+ *
+ * @author Knitter
+ */
+public class DiskGroupChildren extends Children.Keys {
+
+    private Long parentId;
+    private List items;
+    private CatalogEngine eng;
+
+    public DiskGroupChildren(Long parentId) {
+        this.parentId = parentId;
+        items = new LinkedList();
+        eng = Lookup.getDefault().lookup(CatalogEngine.class);
+        Session s = eng.sessionFactory.getCurrentSession();
+        s.beginTransaction();
+        items.addAll(s.createQuery(&quot;from DiskGroup group where group.parent.id = ?&quot;).setLong(0, parentId).list());
+        items.addAll(s.createQuery(&quot;from Media disk where disk.group.id = ?&quot;).setLong(0, parentId).list());
+        s.getTransaction().commit();
+    }
+
+    @Override
+    protected void addNotify() {
+        List keys = items;
+        setKeys(keys);
+    }
+
+    @Override
+    protected Node[] createNodes(Object key) {
+        if (key instanceof DiskGroup) {
+            Session s = eng.sessionFactory.getCurrentSession();
+            s.beginTransaction();
+            List rs = s.createQuery(&quot;from DiskGroup group where parent.id = ?&quot;).setLong(0, ((DiskGroup) key).getId()).list();
+            rs.addAll(s.createQuery(&quot;from Media media where group.id = ?&quot;).setLong(0, ((DiskGroup) key).getId()).list());
+            s.getTransaction().commit();
+
+            DiskGroupNode gn = new DiskGroupNode((DiskGroup) key, rs.isEmpty());
+            return new Node[]{gn};
+        }
+        if (key instanceof Media) {
+            DiskNode in = new DiskNode((Media) key);
+            return new Node[]{in};
+        }
+        return null;
+    }
+
+}

Modified: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/DiskGroupNode.java
===================================================================
--- trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/DiskGroupNode.java	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/DiskGroupNode.java	2008-06-02 23:30:26 UTC (rev 126)
@@ -24,7 +24,10 @@
 import java.awt.Image;
 import org.openide.nodes.AbstractNode;
 import org.openide.nodes.Children;
+import org.openide.util.Lookup;
 import org.openide.util.Utilities;
+import org.openide.util.actions.SystemAction;
+import org.openide.util.lookup.Lookups;
 
 /**
  *
@@ -32,8 +35,8 @@
  */
 public class DiskGroupNode extends AbstractNode {
     
-    public DiskGroupNode(DiskGroup group) {
-        super(Children.LEAF);
+    public DiskGroupNode(DiskGroup group, boolean leaf) {
+        super((leaf ? Children.LEAF : new DiskGroupChildren(group.getId())));
         setName(group.getName());
     }
     
@@ -45,6 +48,10 @@
     @Override
     public Image getOpenedIcon(int type) {
         return getIcon(type);
+    }
+    
+    @Override
+    public SystemAction[] getActions(boolean bool) {
+        return new SystemAction[]{};
     }    
-
 }

Modified: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/DiskNode.java
===================================================================
--- trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/DiskNode.java	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/DiskNode.java	2008-06-02 23:30:26 UTC (rev 126)
@@ -25,6 +25,7 @@
 import org.openide.nodes.AbstractNode;
 import org.openide.nodes.Children;
 import org.openide.util.Utilities;
+import org.openide.util.actions.SystemAction;
 
 /**
  *
@@ -34,6 +35,7 @@
     
     public DiskNode(Media media) {
         super(Children.LEAF);
+        setName(media.getName());
     }
     
     @Override
@@ -45,6 +47,11 @@
     @Override
     public Image getOpenedIcon(int type) {
         return getIcon(type);
+    }
+    
+    @Override
+    public SystemAction[] getActions(boolean bool) {
+        return new SystemAction[]{};
     }    
 
 }

Added: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/FileWrapperNode.java
===================================================================
--- trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/FileWrapperNode.java	2008-05-30 16:02:53 UTC (rev 125)
+++ trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/nodes/FileWrapperNode.java	2008-06-02 23:30:26 UTC (rev 126)
@@ -0,0 +1,44 @@
+/*
+ * To change this template, choose Tools | Templates
+ * and open the template in the editor.
+ */
+
+package de.berlios.jfindmyfiles.jfindmyfilesgui.nodes;
+
+import de.berlios.jfindmyfiles.catalog.CatalogEngine;
+import java.awt.Image;
+import org.openide.nodes.AbstractNode;
+import org.openide.nodes.Children;
+import org.openide.util.Lookup;
+import org.openide.util.Utilities;
+import org.openide.util.actions.SystemAction;
+
+/**
+ *
+ * @author Knitter
+ */
+public class FileWrapperNode extends AbstractNode {
+    
+    public FileWrapperNode() {
+       super(Children.LEAF);
+
+        CatalogEngine eng = Lookup.getDefault().lookup(CatalogEngine.class);
+        setName(eng.getProperties().getName());
+    }
+
+    @Override
+    public Image getIcon(int type) {//TODO: remove icon and replace with correct one
+        return Utilities.loadImage(&quot;de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x16/icon-audio.png&quot;); // NOI18N
+    }
+
+    @Override
+    public Image getOpenedIcon(int type) {
+        return getIcon(type);
+    }
+
+    @Override
+    public SystemAction[] getActions(boolean bool) {
+        return new SystemAction[]{};
+    }
+
+}

Added: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-csv.png
===================================================================
(Binary files differ)


Property changes on: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-csv.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-html.png
===================================================================
(Binary files differ)


Property changes on: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-html.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-ods.png
===================================================================
(Binary files differ)


Property changes on: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-ods.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-sql.png
===================================================================
(Binary files differ)


Property changes on: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-sql.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-xls.png
===================================================================
(Binary files differ)


Property changes on: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-xls.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-xml.png
===================================================================
(Binary files differ)


Property changes on: trunk/project/JFindMyFiles/JFindMyFilesGui/src/de/berlios/jfindmyfiles/jfindmyfilesgui/resources/images/x48/export-import-xml.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	
	<LI>Next message: <A HREF="000122.html">[Jfindmyfiles-commits] r127 - in trunk/docs/Iteracao2-CB05: .	TestingDB
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#121">[ date ]</a>
              <a href="thread.html#121">[ thread ]</a>
              <a href="subject.html#121">[ subject ]</a>
              <a href="author.html#121">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/jfindmyfiles-commits">More information about the Jfindmyfiles-commits
mailing list</a><br>
</body></html>
